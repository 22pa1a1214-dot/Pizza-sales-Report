-- Query 1: Orders by Day of Week
SELECT DATENAME(DW, order_date) AS order_day,
COUNT(DISTINCT order_id) AS total_orders
FROM pizza_sales
WHERE DATEPART(QUARTER, order_date) = 1
GROUP BY DATENAME(DW, order_date);

-- Query 2: Orders by Hour
SELECT DATEPART(HOUR, order_time) AS order_hours,
COUNT(DISTINCT order_id) AS total_orders
FROM pizza_sales
GROUP BY DATEPART(HOUR, order_time)
ORDER BY DATEPART(HOUR, order_time);

-- Query 3: Total Revenue and Percentage by Pizza Category
SELECT pizza_category,CAST(SUM(total_price) AS DECIMAL(10,2)) AS total_revenue,
CAST(SUM(total_price) * 100.0 /(SELECT SUM(total_price)
FROM pizza_sales) AS DECIMAL(10,2)) AS PCT
FROM pizza_sales
GROUP BY pizza_category;


--------KPI's------------

-- 1. Total Revenue
SELECT SUM(total_price) AS Total_Revenue
FROM pizza_sales;

-- 2. Average Order Value
SELECT SUM(total_price) / COUNT(DISTINCT order_id) AS Avg_order_value
FROM pizza_sales;

-- 3. Total Pizzas Sold
SELECT SUM(quantity) AS Total_pizza_sold
FROM pizza_sales;

--4.Total Orders
SELECT SUM(total_price) AS Total_Revenue
FROM pizza_sales;

--5.Avg Pizzas per Order
SELECT ROUND(SUM(total_price), 2) AS Total_Revenue
FROM pizza_sales;
